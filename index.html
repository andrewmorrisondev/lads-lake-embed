<!DOCTYPE html>
  <html lang='en'>
  <head>
      <meta charset='UTF-8'>
      <meta name='viewport' content='width=device-width, initial-scale=1.0'>
      <title>Geolocation iFrame</title>
  </head>
  <body>
      <script>
          let watchID = null;

          function startWatching() {
              if (navigator.geolocation) {
                  if (watchID === null) {
                      watchID = navigator.geolocation.watchPosition(
                          (position) => {
                              const lat = position.coords.latitude;
                              const lon = position.coords.longitude;

                              // Send the latitude and longitude to the parent container
                              window.parent.postMessage({ latitude: lat, longitude: lon }, '*');
                          },
                          (error) => {
                              switch (error.code) {
                                  case error.PERMISSION_DENIED:
                                      console.error('User denied the request for Geolocation.');
                                      break;
                                  case error.POSITION_UNAVAILABLE:
                                      console.error('Location information is unavailable.');
                                      break;
                                  case error.TIMEOUT:
                                      console.error('The request to get user location timed out.');
                                      break;
                                  case error.UNKNOWN_ERROR:
                                      console.error('An unknown error occurred.');
                                      break;
                              }
                          },
                          {
                            enableHighAccuracy: true,
                            timeout: 5000,
                            maximumAge: 0,
                          }
                      );
                  } else {
                      console.log('Already watching position.');
                  }
              } else {
                  console.error('Geolocation is not supported by this browser.');
              }
          }

          function stopWatching() {
              if (watchID !== null) {
                  navigator.geolocation.clearWatch(watchID);
                  console.log('Stopped watching position.');
                  watchID = null;
              }
          }

          // Automatically start watching when the iframe loads
          window.onload = startWatching;
      </script>
  </body>
</html>